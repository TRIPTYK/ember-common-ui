{"version":3,"file":"tpk-form.js","sources":["../../src/components/tpk-form.gts"],"sourcesContent":["import type Owner from '@ember/owner';\nimport { service } from '@ember/service';\nimport Component from '@glimmer/component';\nimport type { Promisable } from 'type-fest';\nimport { assert } from '@ember/debug';\nimport { task } from 'ember-concurrency';\nimport { ImmerChangeset, isChangeset } from 'ember-immer-changeset';\nimport { Schema } from 'yup';\nimport { isFieldError } from '../utils/is-field-error.ts';\nimport perform from 'ember-concurrency/helpers/perform';\nimport {\n  validateAndMapErrors,\n  validateOneAndMapErrors,\n} from '../utils/validate-and-map.ts';\nimport type { WithBoundArgs } from '@glint/template';\nimport TpkValidationInputComponent from '../components/tpk-validation-input.gts';\nimport TpkValidationTextareaComponent from '../components/tpk-validation-textarea.gts';\nimport TpkValidationSelect from '../components/tpk-validation-select.gts';\nimport TpkValidationFileComponent from '../components/tpk-validation-file.gts';\nimport TpkValidationRadioComponent from '../components/tpk-validation-radio.gts';\nimport TpkValidationCheckboxComponent from '../components/tpk-validation-checkbox.gts';\nimport TpkValidationDatepickerComponent from '../components/tpk-validation-datepicker.gts';\nimport TpkFormService from '../services/tpk-form.ts';\nimport TpkValidationInputPrefabComponent from '../components/prefabs/tpk-validation-input.gts';\nimport type TpkValidationTextareaPrefabComponent from './prefabs/tpk-validation-textarea.gts';\nimport type TpkValidationSelectPrefabComponent from './prefabs/tpk-validation-select.gts';\nimport type TpkValidationSelectCreatePrefabComponent from './prefabs/tpk-validation-select-create.gts';\nimport type TpkValidationSelectSearchPrefabComponent from './prefabs/tpk-validation-select-search.gts';\nimport type TpkValidationCheckboxPrefabComponent from './prefabs/tpk-validation-checkbox.gts';\nimport type TpkValidationDatepickerPrefabComponent from './prefabs/tpk-validation-datepicker.gts';\nimport type TpkValidationDatepickerRangePrefabComponent from './prefabs/tpk-validation-datepicker-range.gts';\nimport type TpkValidationTimepickerPrefabComponent from './prefabs/tpk-validation-timepicker.gts';\nimport type TpkValidationPasswordPrefabComponent from './prefabs/tpk-validation-password.gts';\nimport type TpkValidationCurrencyPrefabComponent from './prefabs/tpk-validation-currency.gts';\nimport type TpkValidationIntegerComponent from '../components/prefabs/tpk-validation-integer.gts';\nimport type TpkValidationEmailPrefabComponent from './prefabs/tpk-validation-email.gts';\nimport type TpkValidationIBANPrefabComponent from './prefabs/tpk-validation-iban.gts';\nimport type TpkValidationMobilePrefabComponent from './prefabs/tpk-validation-mobile.gts';\nimport type TpkValidationNumberPrefabComponent from './prefabs/tpk-validation-number.gts';\nimport type TpkValidationBicPrefabComponent from './prefabs/tpk-validation-bic.gts';\nimport type TpkValidationNationalNumberPrefabComponent from './prefabs/tpk-validation-national-number.gts';\nimport type TpkValidationVATPrefabComponent from './prefabs/tpk-validation-vat.gts';\nimport { getRequiredFields } from '../utils/get-required-fields.ts';\nimport { tracked } from '@glimmer/tracking';\nimport scrollOnError from '../modifiers/scroll-on-error.ts';\nimport { on } from '@ember/modifier';\nimport { hash } from '@ember/helper';\nimport type TpkValidationRadioGroupComponent from './tpk-validation-radio-group.gts';\nimport type TpkValidationRadioPrefabComponent from './prefabs/tpk-validation-radio.gts';\nimport type TpkValidationRadioGroupPrefabComponent from './prefabs/tpk-validation-radio-group.gts';\nimport type TpkValidationFilePrefabComponent from './prefabs/tpk-validation-file.gts';\n\ninterface ChangesetFormComponentArgs<T extends ImmerChangeset> {\n  changeset: T;\n  onSubmit: (changeset: T) => Promisable<unknown>;\n  validationSchema: Schema;\n  reactive?: boolean;\n  removeErrorsOnSubmit?: boolean;\n  autoScrollOnError?: boolean;\n  disabled?: boolean;\n  executeOnValid?: boolean;\n}\n\nexport interface ChangesetFormComponentSignature<T extends ImmerChangeset> {\n  Args: ChangesetFormComponentArgs<T>;\n  Blocks: {\n    default: [\n      {\n        TpkInput: WithBoundArgs<\n          typeof TpkValidationInputComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkInputPrefab: WithBoundArgs<\n          typeof TpkValidationInputPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkTextarea: WithBoundArgs<\n          typeof TpkValidationTextareaComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkTextareaPrefab: WithBoundArgs<\n          typeof TpkValidationTextareaPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkSelect: WithBoundArgs<\n          typeof TpkValidationSelect,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkSelectPrefab: WithBoundArgs<\n          typeof TpkValidationSelectPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkSelectCreatePrefab: WithBoundArgs<\n          typeof TpkValidationSelectCreatePrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkSelectSearchPrefab: WithBoundArgs<\n          typeof TpkValidationSelectSearchPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkCheckbox: WithBoundArgs<\n          typeof TpkValidationCheckboxComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkCheckboxPrefab: WithBoundArgs<\n          typeof TpkValidationCheckboxPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkRadio: WithBoundArgs<\n          typeof TpkValidationRadioComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkRadioGroup: WithBoundArgs<\n          typeof TpkValidationRadioGroupComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkRadioPrefab: WithBoundArgs<\n          typeof TpkValidationRadioPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkRadioGroupPrefab: WithBoundArgs<\n          typeof TpkValidationRadioGroupPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkFile: WithBoundArgs<\n          typeof TpkValidationFileComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkDatepicker: WithBoundArgs<\n          typeof TpkValidationDatepickerComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkDatepickerPrefab: WithBoundArgs<\n          typeof TpkValidationDatepickerPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkDatepickerRangePrefab: WithBoundArgs<\n          typeof TpkValidationDatepickerRangePrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkTimepickerPrefab: WithBoundArgs<\n          typeof TpkValidationTimepickerPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkPasswordPrefab: WithBoundArgs<\n          typeof TpkValidationPasswordPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkEmailPrefab: WithBoundArgs<\n          typeof TpkValidationEmailPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkIbanPrefab: WithBoundArgs<\n          typeof TpkValidationIBANPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkBicPrefab: WithBoundArgs<\n          typeof TpkValidationBicPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkVatPrefab: WithBoundArgs<\n          typeof TpkValidationVATPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkNationalNumberPrefab: WithBoundArgs<\n          typeof TpkValidationNationalNumberPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkCurrencyPrefab: WithBoundArgs<\n          typeof TpkValidationCurrencyPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkIntegerPrefab: WithBoundArgs<\n          typeof TpkValidationIntegerComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkNumberPrefab: WithBoundArgs<\n          typeof TpkValidationNumberPrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkMobilePrefab: WithBoundArgs<\n          typeof TpkValidationMobilePrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        TpkFilePrefab: WithBoundArgs<\n          typeof TpkValidationFilePrefabComponent,\n          'changeset' | 'disabled' | 'requiredFields'\n        >;\n        changesetGet: (path: string) => unknown;\n        requiredFields: string[];\n      },\n    ];\n  };\n  Element: HTMLFormElement;\n}\n\nexport default class ChangesetFormComponent<\n  T extends ImmerChangeset,\n> extends Component<ChangesetFormComponentSignature<T>> {\n  @tracked declare requiredFields: string[];\n  @service declare tpkForm: TpkFormService;\n\n  public constructor(owner: Owner, args: ChangesetFormComponentArgs<T>) {\n    super(owner, args);\n    assert(\n      '@changeset is required and must be an ImmerChangeset',\n      isChangeset(args.changeset) && args.changeset instanceof ImmerChangeset,\n    );\n    assert('@onSubmit is required', typeof args.onSubmit === 'function');\n    assert(\n      '@validationSchema is required',\n      args.validationSchema instanceof Schema,\n    );\n\n    this.requiredFields =\n      getRequiredFields(this.args.validationSchema, this.args.changeset.data) ??\n      [];\n    this.args.changeset.onSet(async () => {\n      await this.args.changeset.validate((draft) => {\n        this.requiredFields =\n          getRequiredFields(this.args.validationSchema, draft) ?? [];\n      });\n    });\n\n    if (args.reactive ?? true) {\n      this.args.changeset.onSet(async (key) => {\n        await this.args.changeset.validate(async (draft) => {\n          const errors = await validateOneAndMapErrors(\n            key,\n            this.args.validationSchema,\n            draft,\n          );\n\n          for (const error of this.args.changeset.errors) {\n            if (isFieldError(key, error.key)) {\n              this.args.changeset.removeError(error.key);\n            }\n          }\n\n          for (const error of errors) {\n            this.args.changeset.addError(error);\n          }\n        });\n      });\n    }\n  }\n\n  validateAndSubmit = task(this, { drop: true }, async () => {\n    if (this.args.removeErrorsOnSubmit ?? true) {\n      this.args.changeset.removeErrors();\n    }\n\n    await this.args.changeset.validate(async (dto) => {\n      const errors = await validateAndMapErrors(\n        this.args.validationSchema,\n        dto,\n      );\n      for (const error of errors) {\n        this.args.changeset.addError(error);\n      }\n    });\n\n    if (!this.args.changeset.isValid) {\n      return;\n    }\n\n    if (this.args.executeOnValid ?? true) {\n      this.args.changeset.execute();\n    }\n\n    await this.args.onSubmit(this.args.changeset);\n  });\n\n  submit = task(this, async (e: Event) => {\n    e.preventDefault();\n    await this.validateAndSubmit.perform();\n  });\n\n  changesetGet = (path: string) => {\n    return this.args.changeset.get(path);\n  };\n\n  get errorsForScroll() {\n    return this.args.autoScrollOnError ?? true\n      ? this.args.changeset.errors\n      : [];\n  }\n\n  <template>\n    <form\n      {{on 'submit' (perform this.submit)}}\n      {{scrollOnError this.errorsForScroll}}\n      ...attributes\n    >\n      {{yield\n        (hash\n          TpkInput=(component\n            this.tpkForm.TpkInput\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkInputPrefab=(component\n            this.tpkForm.TpkInputPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkTextarea=(component\n            this.tpkForm.TpkTextarea\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkTextareaPrefab=(component\n            this.tpkForm.TpkTextareaPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkSelect=(component\n            this.tpkForm.TpkSelect\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkSelectPrefab=(component\n            this.tpkForm.TpkSelectPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkSelectCreatePrefab=(component\n            this.tpkForm.TpkSelectCreatePrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkSelectSearchPrefab=(component\n            this.tpkForm.TpkSelectSearchPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkCheckbox=(component\n            this.tpkForm.TpkCheckbox\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkCheckboxPrefab=(component\n            this.tpkForm.TpkCheckboxPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkRadio=(component\n            this.tpkForm.TpkRadio\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkFile=(component\n            this.tpkForm.TpkFile\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkDatepicker=(component\n            this.tpkForm.TpkDatepicker\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkDatepickerPrefab=(component\n            this.tpkForm.TpkDatepickerPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkDatepickerRangePrefab=(component\n            this.tpkForm.TpkDatepickerRangePrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkTimepickerPrefab=(component\n            this.tpkForm.TpkTimepickerPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkPasswordPrefab=(component\n            this.tpkForm.TpkPasswordPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkEmailPrefab=(component\n            this.tpkForm.TpkEmailPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkIbanPrefab=(component\n            this.tpkForm.TpkIbanPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkBicPrefab=(component\n            this.tpkForm.TpkBicPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkVatPrefab=(component\n            this.tpkForm.TpkVatPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkNationalNumberPrefab=(component\n            this.tpkForm.TpkNationalNumberPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkCurrencyPrefab=(component\n            this.tpkForm.TpkCurrencyPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkIntegerPrefab=(component\n            this.tpkForm.TpkIntegerPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkNumberPrefab=(component\n            this.tpkForm.TpkNumberPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkMobilePrefab=(component\n            this.tpkForm.TpkMobilePrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkRadioGroup=(component\n            this.tpkForm.TpkRadioGroup\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkRadioPrefab=(component\n            this.tpkForm.TpkRadioPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkRadioGroupPrefab=(component\n            this.tpkForm.TpkRadioGroupPrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          TpkFilePrefab=(component\n            this.tpkForm.TpkFilePrefab\n            changeset=@changeset\n            disabled=@disabled\n            requiredFields=this.requiredFields\n          )\n          changesetGet=this.changesetGet\n          requiredFields=this.requiredFields\n        )\n      }}\n    </form>\n  </template>\n}\n"],"names":["ChangesetFormComponent","_class","_ChangesetFormComponent","Component","constructor","owner","args","_initializerDefineProperty","_descriptor","_descriptor2","_defineProperty","_buildTask","context","generator","removeErrorsOnSubmit","changeset","removeErrors","validate","dto","errors","validateAndMapErrors","validationSchema","error","addError","isValid","executeOnValid","execute","onSubmit","drop","e","preventDefault","validateAndSubmit","perform","path","get","assert","isChangeset","ImmerChangeset","Schema","requiredFields","getRequiredFields","data","onSet","draft","reactive","key","validateOneAndMapErrors","isFieldError","removeError","errorsForScroll","autoScrollOnError","setComponentTemplate","precompileTemplate","strictMode","scope","on","scrollOnError","hash","_applyDecoratedDescriptor","prototype","tracked","configurable","enumerable","writable","initializer","service"],"mappings":"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"}