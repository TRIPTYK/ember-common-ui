{"version":3,"file":"input.js","sources":["../../../src/components/tpk-input/input.gts"],"sourcesContent":["import { on } from '@ember/modifier';\nimport Component from '@glimmer/component';\nimport didInsert from '@ember/render-modifiers/modifiers/did-insert';\nimport didUpdate from '@ember/render-modifiers/modifiers/did-update';\nimport { action } from '@ember/object';\nimport { tracked } from 'tracked-built-ins';\nimport type { FactoryArg, InputMask } from 'imask';\nimport IMask from 'imask';\n\nexport interface TpkInputInputComponentSignature {\n  Args: {\n    guid: string;\n    type?: string;\n    placeholder?: string;\n    mask?: unknown;\n    maskOptions?: Record<string, unknown>;\n    unmaskValue?: boolean;\n    disabled?: boolean;\n    min?: number;\n    step?: number;\n    max?: number;\n    value?: string | number | boolean | null | undefined;\n    changeEvent: 'input' | 'change';\n    onChange?: (value: string | number | Date | null, e: Event) => unknown;\n  };\n  Element: HTMLInputElement;\n  Blocks: {\n    default: unknown[];\n  };\n}\n\nexport default class TpkInputInputComponent extends Component<TpkInputInputComponentSignature> {\n  @tracked mask?: InputMask<FactoryArg>;\n\n  get value() {\n    if (this.mask) {\n      return this.mask.displayValue;\n    }\n    return this.args.value;\n  }\n\n  @action onChange(e: Event): void {\n    e.preventDefault();\n    let value = this.inputValue(e.target as HTMLInputElement);\n    if (this.mask) {\n      value = this.args.unmaskValue ? this.mask.typedValue : this.mask.value;\n    }\n    this.args.onChange?.(value, e);\n  }\n\n  private inputValue(input: HTMLInputElement) {\n    if (this.args.type === 'number') {\n      return input.valueAsNumber;\n    }\n\n    if (this.args.type === 'date') {\n      return input.valueAsDate;\n    }\n\n    return input.value;\n  }\n\n  @action\n  setMask(element: HTMLInputElement) {\n    if (!this.args.mask) return;\n\n    this.mask = IMask(element, {\n      mask: this.args.mask,\n      ...this.args.maskOptions,\n    } as Record<string, unknown>);\n  }\n\n  <template>\n    <input\n      id={{@guid}}\n      min={{@min}}\n      step={{@step}}\n      max={{@max}}\n      type={{@type}}\n      value={{this.value}}\n      disabled={{@disabled}}\n      placeholder={{@placeholder}}\n      {{didInsert this.setMask}}\n      {{didUpdate this.setMask @mask}}\n      {{on @changeEvent this.onChange}}\n      ...attributes\n      data-test-tpk-input-input\n    />\n  </template>\n}\n"],"names":["TpkInputInputComponent","Component","constructor","args","_initializerDefineProperty","_descriptor","value","mask","displayValue","onChange","e","preventDefault","inputValue","target","unmaskValue","typedValue","input","type","valueAsNumber","valueAsDate","setMask","element","IMask","maskOptions","setComponentTemplate","precompileTemplate","strictMode","scope","didInsert","didUpdate","on","_TpkInputInputComponent","_applyDecoratedDescriptor","_class","prototype","tracked","configurable","enumerable","writable","initializer","action","Object","getOwnPropertyDescriptor"],"mappings":";;;;;;;;;;;;AA+BqBA,IAAAA,8DAAN,MAAMA,+BAA+BC,SAAU,CAAA;AAAAC,EAAAA,WAAAA,CAAA,GAAAC,IAAA,EAAA;AAAA,IAAA,KAAA,CAAA,GAAAA,IAAA,CAAA,CAAA;AAAAC,IAAAA,0BAAA,eAAAC,WAAA,EAAA,IAAA,CAAA,CAAA;AAAA,GAAA;EAG5D,IAAIC,KAAQA,GAAA;IACV,IAAI,IAAI,CAACC,IAAI,EAAE;AACb,MAAA,OAAO,IAAI,CAACA,IAAI,CAACC,YAAY,CAAA;AAC/B,KAAA;AACA,IAAA,OAAO,IAAI,CAACL,IAAI,CAACG,KAAK,CAAA;AACxB,GAAA;EAEQG,QAAAA,CAASC,CAAQ,EAAQ;IAC/BA,CAAA,CAAEC,cAAc,EAAA,CAAA;IAChB,IAAIL,QAAQ,IAAI,CAACM,UAAU,CAACF,CAAA,CAAEG,MAAU,CAAA,CAAA;IACxC,IAAI,IAAI,CAACN,IAAI,EAAE;AACbD,MAAAA,KAAA,GAAQ,IAAI,CAACH,IAAI,CAACW,WAAW,GAAG,IAAI,CAACP,IAAI,CAACQ,UAAU,GAAG,IAAI,CAACR,IAAI,CAACD,KAAK,CAAA;AACxE,KAAA;IACA,IAAI,CAACH,IAAI,CAACM,QAAQ,GAAGH,KAAO,EAAAI,CAAA,CAAA,CAAA;AAC9B,GAAA;EAEQE,UAAAA,CAAWI,KAAuB,EAAE;AAC1C,IAAA,IAAI,IAAI,CAACb,IAAI,CAACc,IAAI,KAAK,QAAU,EAAA;MAC/B,OAAOD,MAAME,aAAa,CAAA;AAC5B,KAAA;AAEA,IAAA,IAAI,IAAI,CAACf,IAAI,CAACc,IAAI,KAAK,MAAQ,EAAA;MAC7B,OAAOD,MAAMG,WAAW,CAAA;AAC1B,KAAA;IAEA,OAAOH,MAAMV,KAAK,CAAA;AACpB,GAAA;EAGAc,OAAQA,CAAAC,OAAyB,EAAE;AACjC,IAAA,IAAI,CAAC,IAAI,CAAClB,IAAI,CAACI,IAAI,EAAE,OAAA;AAErB,IAAA,IAAI,CAACA,IAAI,GAAGe,KAAA,CAAMD,OAAS,EAAA;AACzBd,MAAAA,IAAA,EAAM,IAAI,CAACJ,IAAI,CAACI,IAAI;MACpB,GAAG,IAAI,CAACJ,IAAI,CAACoB,WAAAA;AACf,KAA2B,CAAA,CAAA;AAC7B,GAAA;AAmBF,CAAA,EAAAC,oBAAA,CAjBEC,kBAAA,CAgBA,ySAAA,EAAA;EAAAC,UAAA,EAAA,IAAA;AAAAC,EAAAA,KAAA,EAAAA,OAAA;IAAAC,SAAA;IAAAC,SAAA;AAAAC,IAAAA,EAAAA;AAAA,GAAA,CAAA;AAAU,CAAA,CAAA,EAAAC,uBAAA,CAAA,EAAAA,uBAAA,CAAA1B,EAAAA,WAAA,GAAA2B,yBAAA,CAAAC,MAAA,CAAAC,SAAA,WAxDTC,OAAA,CAAA,EAAA;EAAAC,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAA,CAAA,EAAAP,yBAAA,CAAAC,MAAA,CAAAC,SAAA,EAAA,UAAA,EAAA,CASAM,MAAA,CAAAC,EAAAA,MAAA,CAAAC,wBAAA,CAAAT,MAAA,CAAAC,SAAA,EAAAD,UAAAA,CAAAA,EAAAA,MAAA,CAAAC,SAAA,CAAA,EAAAF,yBAAA,CAAAC,MAAA,CAAAC,SAAA,cAqBAM,MAAA,CAAA,EAAAC,MAAA,CAAAC,wBAAA,CAAAT,MAAA,CAAAC,SAAA,EAAA,SAAA,CAAA,EAAAD,MAAA,CAAAC,SAAA,GAAAD,MAAA;;;;"}